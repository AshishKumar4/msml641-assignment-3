(flax) mrwhite0racle@White0racle:~/Desktop/UMDCourseWork/MSML641/Homework3$ python3 main.py 
Loading and preprocessing data...

Running all experiments...

================================================================================
Running Baseline
================================================================================

Training: LSTM | Act=tanh | Opt=adam | Seq=50 | Clip=No
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 113.50it/s]
Epoch 1/30 - Loss: 0.5555 - Accuracy: 0.7488 - F1: 0.7488 - Time: 6.99s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 209.96it/s]
Epoch 2/30 - Loss: 0.4035 - Accuracy: 0.7631 - F1: 0.7612 - Time: 3.85s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 210.17it/s]
Epoch 3/30 - Loss: 0.3286 - Accuracy: 0.7580 - F1: 0.7578 - Time: 3.80s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 212.07it/s]
Epoch 4/30 - Loss: 0.2562 - Accuracy: 0.7563 - F1: 0.7554 - Time: 3.81s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.61it/s]
Epoch 5/30 - Loss: 0.2022 - Accuracy: 0.7598 - F1: 0.7597 - Time: 3.78s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.57it/s]
Epoch 6/30 - Loss: 0.1444 - Accuracy: 0.7526 - F1: 0.7526 - Time: 3.77s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 212.05it/s]
Epoch 7/30 - Loss: 0.1097 - Accuracy: 0.7534 - F1: 0.7533 - Time: 3.76s
Early stopping at epoch 7
Results: Accuracy=0.7631, F1=0.7612, Best Epoch=2, Avg Epoch Time=4.25s
Confusion Matrix:
[[ 8417  4057]
 [ 1866 10660]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.82      0.67      0.74     12474
    Positive       0.72      0.85      0.78     12526

    accuracy                           0.76     25000
   macro avg       0.77      0.76      0.76     25000
weighted avg       0.77      0.76      0.76     25000


================================================================================
Experiment - 1: MODEL ARCHITECTURE
================================================================================

Training: RNN | Act=tanh | Opt=adam | Seq=50 | Clip=No
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:04<00:00, 173.08it/s]
Epoch 1/30 - Loss: 0.7043 - Accuracy: 0.5425 - F1: 0.5202 - Time: 4.59s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 365.53it/s]
Epoch 2/30 - Loss: 0.6669 - Accuracy: 0.5277 - F1: 0.4417 - Time: 2.22s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 363.22it/s]
Epoch 3/30 - Loss: 0.6883 - Accuracy: 0.5338 - F1: 0.4548 - Time: 2.23s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 364.62it/s]
Epoch 4/30 - Loss: 0.6699 - Accuracy: 0.6154 - F1: 0.6098 - Time: 2.23s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 364.59it/s]
Epoch 5/30 - Loss: 0.6810 - Accuracy: 0.5598 - F1: 0.5548 - Time: 2.23s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 364.72it/s]
Epoch 6/30 - Loss: 0.6400 - Accuracy: 0.6539 - F1: 0.6490 - Time: 2.22s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 365.96it/s]
Epoch 7/30 - Loss: 0.6008 - Accuracy: 0.6516 - F1: 0.6504 - Time: 2.25s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 365.09it/s]
Epoch 8/30 - Loss: 0.5507 - Accuracy: 0.7201 - F1: 0.7199 - Time: 2.22s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 365.91it/s]
Epoch 9/30 - Loss: 0.5009 - Accuracy: 0.7242 - F1: 0.7240 - Time: 2.22s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 364.94it/s]
Epoch 10/30 - Loss: 0.4867 - Accuracy: 0.7091 - F1: 0.7086 - Time: 2.23s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 365.11it/s]
Epoch 11/30 - Loss: 0.4536 - Accuracy: 0.7047 - F1: 0.7047 - Time: 2.22s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 368.08it/s]
Epoch 12/30 - Loss: 0.4816 - Accuracy: 0.7012 - F1: 0.7011 - Time: 2.20s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 366.28it/s]
Epoch 13/30 - Loss: 0.4305 - Accuracy: 0.7220 - F1: 0.7220 - Time: 2.21s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 360.76it/s]
Epoch 14/30 - Loss: 0.4029 - Accuracy: 0.7225 - F1: 0.7224 - Time: 2.25s
Early stopping at epoch 14
Results: Accuracy=0.7242, F1=0.7240, Best Epoch=9, Avg Epoch Time=2.39s
Confusion Matrix:
[[8770 3704]
 [3192 9334]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.73      0.70      0.72     12474
    Positive       0.72      0.75      0.73     12526

    accuracy                           0.72     25000
   macro avg       0.72      0.72      0.72     25000
weighted avg       0.72      0.72      0.72     25000

Skipping duplicate: ('tanh', False, 'lstm', 'adam', 50)

Training: BILSTM | Act=tanh | Opt=adam | Seq=50 | Clip=No
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:11<00:00, 70.47it/s]
Epoch 1/30 - Loss: 0.5667 - Accuracy: 0.7604 - F1: 0.7604 - Time: 11.20s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:07<00:00, 105.78it/s]
Epoch 2/30 - Loss: 0.4108 - Accuracy: 0.7692 - F1: 0.7676 - Time: 7.47s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:07<00:00, 104.06it/s]
Epoch 3/30 - Loss: 0.3286 - Accuracy: 0.7595 - F1: 0.7594 - Time: 7.60s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:07<00:00, 105.85it/s]
Epoch 4/30 - Loss: 0.2538 - Accuracy: 0.7563 - F1: 0.7562 - Time: 7.50s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:07<00:00, 103.08it/s]
Epoch 5/30 - Loss: 0.1979 - Accuracy: 0.7531 - F1: 0.7520 - Time: 7.67s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:07<00:00, 104.61it/s]
Epoch 6/30 - Loss: 0.1497 - Accuracy: 0.7544 - F1: 0.7544 - Time: 7.55s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:07<00:00, 102.49it/s]
Epoch 7/30 - Loss: 0.1107 - Accuracy: 0.7526 - F1: 0.7525 - Time: 7.71s
Early stopping at epoch 7
Results: Accuracy=0.7692, F1=0.7676, Best Epoch=2, Avg Epoch Time=8.10s
Confusion Matrix:
[[ 8568  3906]
 [ 1864 10662]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.82      0.69      0.75     12474
    Positive       0.73      0.85      0.79     12526

    accuracy                           0.77     25000
   macro avg       0.78      0.77      0.77     25000
weighted avg       0.78      0.77      0.77     25000


================================================================================
Experiment - 2: ACTIVATION FUNCTIONS
================================================================================

Training: LSTM | Act=sigmoid | Opt=adam | Seq=50 | Clip=No
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 126.58it/s]
Epoch 1/30 - Loss: 0.6964 - Accuracy: 0.5314 - F1: 0.4422 - Time: 6.25s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.09it/s]
Epoch 2/30 - Loss: 0.5707 - Accuracy: 0.7402 - F1: 0.7321 - Time: 3.81s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 210.26it/s]
Epoch 3/30 - Loss: 0.4026 - Accuracy: 0.7753 - F1: 0.7753 - Time: 3.80s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 208.19it/s]
Epoch 4/30 - Loss: 0.3371 - Accuracy: 0.7713 - F1: 0.7709 - Time: 3.84s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 207.29it/s]
Epoch 5/30 - Loss: 0.2828 - Accuracy: 0.7662 - F1: 0.7659 - Time: 3.87s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 210.85it/s]
Epoch 6/30 - Loss: 0.2311 - Accuracy: 0.7579 - F1: 0.7577 - Time: 3.80s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.78it/s]
Epoch 7/30 - Loss: 0.1853 - Accuracy: 0.7588 - F1: 0.7588 - Time: 3.78s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.81it/s]
Epoch 8/30 - Loss: 0.1453 - Accuracy: 0.7496 - F1: 0.7491 - Time: 3.77s
Early stopping at epoch 8
Results: Accuracy=0.7753, F1=0.7753, Best Epoch=3, Avg Epoch Time=4.12s
Confusion Matrix:
[[9500 2974]
 [2643 9883]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.78      0.76      0.77     12474
    Positive       0.77      0.79      0.78     12526

    accuracy                           0.78     25000
   macro avg       0.78      0.78      0.78     25000
weighted avg       0.78      0.78      0.78     25000


Training: LSTM | Act=relu | Opt=adam | Seq=50 | Clip=No
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 128.53it/s]
Epoch 1/30 - Loss: 0.7228 - Accuracy: 0.5232 - F1: 0.4015 - Time: 6.16s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 214.92it/s]
Epoch 2/30 - Loss: 0.6945 - Accuracy: 0.6646 - F1: 0.6638 - Time: 3.72s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 214.38it/s]
Epoch 3/30 - Loss: 0.6631 - Accuracy: 0.6169 - F1: 0.6094 - Time: 3.73s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 214.34it/s]
Epoch 4/30 - Loss: 0.6458 - Accuracy: 0.6923 - F1: 0.6893 - Time: 3.73s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.51it/s]
Epoch 5/30 - Loss: 0.6824 - Accuracy: 0.6480 - F1: 0.6415 - Time: 3.78s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 214.36it/s]
Epoch 6/30 - Loss: 0.5499 - Accuracy: 0.6544 - F1: 0.6543 - Time: 3.74s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 212.61it/s]
Epoch 7/30 - Loss: 0.6610 - Accuracy: 0.6183 - F1: 0.6175 - Time: 3.77s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.62it/s]
Epoch 8/30 - Loss: 0.6171 - Accuracy: 0.6382 - F1: 0.6380 - Time: 3.78s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.40it/s]
Epoch 9/30 - Loss: 2.1673 - Accuracy: 0.4970 - F1: 0.4355 - Time: 3.78s
Early stopping at epoch 9
Results: Accuracy=0.6923, F1=0.6893, Best Epoch=4, Avg Epoch Time=4.02s
Confusion Matrix:
[[9870 2604]
 [5089 7437]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.66      0.79      0.72     12474
    Positive       0.74      0.59      0.66     12526

    accuracy                           0.69     25000
   macro avg       0.70      0.69      0.69     25000
weighted avg       0.70      0.69      0.69     25000

Skipping duplicate: ('tanh', False, 'lstm', 'adam', 50)

================================================================================
Experiment - 3: OPTIMIZERS
================================================================================
Skipping duplicate: ('tanh', False, 'lstm', 'adam', 50)

Training: LSTM | Act=tanh | Opt=sgd | Seq=50 | Clip=No
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:05<00:00, 130.77it/s]
Epoch 1/30 - Loss: 0.6935 - Accuracy: 0.5031 - F1: 0.3974 - Time: 6.06s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 212.88it/s]
Epoch 2/30 - Loss: 0.6932 - Accuracy: 0.5204 - F1: 0.5009 - Time: 3.77s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 214.20it/s]
Epoch 3/30 - Loss: 0.6927 - Accuracy: 0.5032 - F1: 0.3591 - Time: 3.76s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 213.65it/s]
Epoch 4/30 - Loss: 0.6921 - Accuracy: 0.5149 - F1: 0.4378 - Time: 3.74s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.44it/s]
Epoch 5/30 - Loss: 0.6908 - Accuracy: 0.5335 - F1: 0.4728 - Time: 3.78s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 212.47it/s]
Epoch 6/30 - Loss: 0.6835 - Accuracy: 0.5292 - F1: 0.4206 - Time: 3.77s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 210.74it/s]
Epoch 7/30 - Loss: 0.6550 - Accuracy: 0.5432 - F1: 0.4282 - Time: 3.80s
Early stopping at epoch 7
Results: Accuracy=0.5204, F1=0.5009, Best Epoch=2, Avg Epoch Time=4.10s
Confusion Matrix:
[[8978 3496]
 [8493 4033]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.51      0.72      0.60     12474
    Positive       0.54      0.32      0.40     12526

    accuracy                           0.52     25000
   macro avg       0.52      0.52      0.50     25000
weighted avg       0.52      0.52      0.50     25000


Training: LSTM | Act=tanh | Opt=rmsprop | Seq=50 | Clip=No
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:05<00:00, 131.37it/s]
Epoch 1/30 - Loss: 0.5851 - Accuracy: 0.7491 - F1: 0.7460 - Time: 6.03s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 213.38it/s]
Epoch 2/30 - Loss: 0.4523 - Accuracy: 0.7648 - F1: 0.7622 - Time: 3.75s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 212.44it/s]
Epoch 3/30 - Loss: 0.4079 - Accuracy: 0.7762 - F1: 0.7761 - Time: 3.76s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 213.57it/s]
Epoch 4/30 - Loss: 0.3741 - Accuracy: 0.7622 - F1: 0.7576 - Time: 3.74s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.55it/s]
Epoch 5/30 - Loss: 0.3417 - Accuracy: 0.7821 - F1: 0.7821 - Time: 3.82s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 212.64it/s]
Epoch 6/30 - Loss: 0.3117 - Accuracy: 0.7706 - F1: 0.7705 - Time: 3.76s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 212.13it/s]
Epoch 7/30 - Loss: 0.2766 - Accuracy: 0.7728 - F1: 0.7728 - Time: 3.81s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 214.12it/s]
Epoch 8/30 - Loss: 0.2390 - Accuracy: 0.7728 - F1: 0.7726 - Time: 3.73s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 212.45it/s]
Epoch 9/30 - Loss: 0.2046 - Accuracy: 0.7590 - F1: 0.7590 - Time: 3.77s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 213.74it/s]
Epoch 10/30 - Loss: 0.1758 - Accuracy: 0.7461 - F1: 0.7451 - Time: 3.74s
Early stopping at epoch 10
Results: Accuracy=0.7821, F1=0.7821, Best Epoch=5, Avg Epoch Time=3.99s
Confusion Matrix:
[[9692 2782]
 [2665 9861]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.78      0.78      0.78     12474
    Positive       0.78      0.79      0.78     12526

    accuracy                           0.78     25000
   macro avg       0.78      0.78      0.78     25000
weighted avg       0.78      0.78      0.78     25000


================================================================================
Experiment - 4: SEQUENCE LENGTHS
================================================================================

Training: LSTM | Act=tanh | Opt=adam | Seq=25 | Clip=No
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:04<00:00, 169.89it/s]
Epoch 1/30 - Loss: 0.5898 - Accuracy: 0.7204 - F1: 0.7204 - Time: 4.69s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 377.96it/s]
Epoch 2/30 - Loss: 0.4585 - Accuracy: 0.7285 - F1: 0.7282 - Time: 2.15s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 381.31it/s]
Epoch 3/30 - Loss: 0.3741 - Accuracy: 0.7158 - F1: 0.7158 - Time: 2.13s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 377.28it/s]
Epoch 4/30 - Loss: 0.2931 - Accuracy: 0.7158 - F1: 0.7158 - Time: 2.16s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 380.35it/s]
Epoch 5/30 - Loss: 0.2259 - Accuracy: 0.7049 - F1: 0.7048 - Time: 2.13s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 381.54it/s]
Epoch 6/30 - Loss: 0.1711 - Accuracy: 0.7040 - F1: 0.7040 - Time: 2.13s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:02<00:00, 378.31it/s]
Epoch 7/30 - Loss: 0.1232 - Accuracy: 0.6984 - F1: 0.6983 - Time: 2.15s
Early stopping at epoch 7
Results: Accuracy=0.7285, F1=0.7282, Best Epoch=2, Avg Epoch Time=2.51s
Confusion Matrix:
[[8671 3803]
 [2984 9542]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.74      0.70      0.72     12474
    Positive       0.72      0.76      0.74     12526

    accuracy                           0.73     25000
   macro avg       0.73      0.73      0.73     25000
weighted avg       0.73      0.73      0.73     25000

Skipping duplicate: ('tanh', False, 'lstm', 'adam', 50)

Training: LSTM | Act=tanh | Opt=adam | Seq=100 | Clip=No
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:09<00:00, 80.27it/s]
Epoch 1/30 - Loss: 0.5893 - Accuracy: 0.7704 - F1: 0.7683 - Time: 9.83s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 113.25it/s]
Epoch 2/30 - Loss: 0.4643 - Accuracy: 0.7329 - F1: 0.7329 - Time: 7.00s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 112.98it/s]
Epoch 3/30 - Loss: 0.4894 - Accuracy: 0.7934 - F1: 0.7922 - Time: 7.00s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 112.73it/s]
Epoch 4/30 - Loss: 0.3549 - Accuracy: 0.8140 - F1: 0.8137 - Time: 7.03s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 112.63it/s]
Epoch 5/30 - Loss: 0.2977 - Accuracy: 0.8190 - F1: 0.8187 - Time: 7.02s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 112.68it/s]
Epoch 6/30 - Loss: 0.2567 - Accuracy: 0.8127 - F1: 0.8127 - Time: 7.07s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 112.79it/s]
Epoch 7/30 - Loss: 0.2161 - Accuracy: 0.8140 - F1: 0.8140 - Time: 7.01s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 112.56it/s]
Epoch 8/30 - Loss: 0.1787 - Accuracy: 0.8053 - F1: 0.8043 - Time: 7.03s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:07<00:00, 109.85it/s]
Epoch 9/30 - Loss: 0.1534 - Accuracy: 0.8080 - F1: 0.8075 - Time: 7.20s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:07<00:00, 111.38it/s]
Epoch 10/30 - Loss: 0.1253 - Accuracy: 0.8030 - F1: 0.8014 - Time: 7.13s
Early stopping at epoch 10
Results: Accuracy=0.8190, F1=0.8187, Best Epoch=5, Avg Epoch Time=7.33s
Confusion Matrix:
[[ 9760  2714]
 [ 1811 10715]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.84      0.78      0.81     12474
    Positive       0.80      0.86      0.83     12526

    accuracy                           0.82     25000
   macro avg       0.82      0.82      0.82     25000
weighted avg       0.82      0.82      0.82     25000


================================================================================
Experiment - 5: GRADIENT CLIPPING
================================================================================
Skipping duplicate: ('tanh', False, 'lstm', 'adam', 50)

Training: LSTM | Act=tanh | Opt=adam | Seq=50 | Clip=Yes
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:06<00:00, 124.99it/s]
Epoch 1/30 - Loss: 0.5551 - Accuracy: 0.7388 - F1: 0.7382 - Time: 6.33s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 210.44it/s]
Epoch 2/30 - Loss: 0.4035 - Accuracy: 0.7644 - F1: 0.7625 - Time: 3.80s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.57it/s]
Epoch 3/30 - Loss: 0.3282 - Accuracy: 0.7623 - F1: 0.7622 - Time: 3.78s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 211.10it/s]
Epoch 4/30 - Loss: 0.2573 - Accuracy: 0.7584 - F1: 0.7577 - Time: 3.79s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 210.67it/s]
Epoch 5/30 - Loss: 0.1972 - Accuracy: 0.7607 - F1: 0.7596 - Time: 3.79s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 210.79it/s]
Epoch 6/30 - Loss: 0.1544 - Accuracy: 0.7520 - F1: 0.7520 - Time: 3.79s
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 782/782 [00:03<00:00, 210.34it/s]
Epoch 7/30 - Loss: 0.1093 - Accuracy: 0.7489 - F1: 0.7489 - Time: 3.80s
Early stopping at epoch 7
Results: Accuracy=0.7644, F1=0.7625, Best Epoch=2, Avg Epoch Time=4.15s
Confusion Matrix:
[[ 8442  4032]
 [ 1859 10667]]
Classification Report:
              precision    recall  f1-score   support

    Negative       0.82      0.68      0.74     12474
    Positive       0.73      0.85      0.78     12526

    accuracy                           0.76     25000
   macro avg       0.77      0.76      0.76     25000
weighted avg       0.77      0.76      0.76     25000


================================================================================
Visualizing Results
================================================================================
Saved: results/plots/metrics_vs_seq_length.png
Saved: results/plots/training_loss_best_worst.png
Saved: results/plots/training_model_type.png
Saved: results/plots/training_activation.png
Saved: results/plots/training_optimizer.png
Saved: results/plots/training_seq_length.png
Saved: results/plots/training_grad_clip.png

================================================================================
Best Configurations per Experiment
================================================================================

MODEL ARCHITECTURE:
  BILSTM | Act=tanh | Opt=adam | Seq=50 | Clip=No
  F1: 0.7676 | Acc: 0.7692

ACTIVATION FUNCTIONS:
  LSTM | Act=sigmoid | Opt=adam | Seq=50 | Clip=No
  F1: 0.7753 | Acc: 0.7753

OPTIMIZERS:
  LSTM | Act=tanh | Opt=rmsprop | Seq=50 | Clip=No
  F1: 0.7821 | Acc: 0.7821

SEQUENCE LENGTHS:
  LSTM | Act=tanh | Opt=adam | Seq=100 | Clip=No
  F1: 0.8187 | Acc: 0.8190

GRADIENT CLIPPING:
  LSTM | Act=tanh | Opt=adam | Seq=50 | Clip=Yes
  F1: 0.7625 | Acc: 0.7644

================================================================================
Summary of Best and Worst Models
================================================================================

Best:
  LSTM | Act=tanh | Opt=adam | Seq=100 | Clip=No
  F1: 0.8187 | Acc: 0.8190

Worst:
  LSTM | Act=tanh | Opt=sgd | Seq=50 | Clip=No
  F1: 0.5009 | Acc: 0.5204
(flax) mrwhite0racle@White0racle:~/Desktop/UMDCourseWork/MSML641/Homework3$ 